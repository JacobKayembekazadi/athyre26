<section class="blog-page section-{{ section.id }}">
  {%- comment -%} Hero {%- endcomment -%}
  <div class="blog-page__hero">
    <div class="container">
      <h1 class="blog-page__title">{{ blog.title }}</h1>
      {%- if section.settings.show_description and blog.metafields.custom.description -%}
        <p class="blog-page__description">{{ blog.metafields.custom.description }}</p>
      {%- endif -%}
    </div>
  </div>

  <div class="container">
    {%- comment -%} Featured Article {%- endcomment -%}
    {%- if section.settings.show_featured and blog.articles.size > 0 -%}
      {%- assign featured = blog.articles.first -%}
      <div class="blog-page__featured">
        <a href="{{ featured.url }}" class="blog-page__featured-link">
          <div class="blog-page__featured-image">
            {%- if featured.image -%}
              <img src="{{ featured.image | image_url: width: 1200 }}" alt="{{ featured.title | escape }}">
            {%- else -%}
              {{ 'lifestyle-1' | placeholder_svg_tag }}
            {%- endif -%}
            <span class="blog-page__featured-category">{{ featured.tags.first | default: 'Journal' }}</span>
          </div>
          <div class="blog-page__featured-content">
            <h2 class="blog-page__featured-title">{{ featured.title }}</h2>
            <p class="blog-page__featured-excerpt">{{ featured.excerpt_or_content | strip_html | truncate: 200 }}</p>
            <div class="blog-page__featured-meta">
              <span>{{ featured.published_at | date: '%B %d, %Y' }}</span>
            </div>
          </div>
        </a>
      </div>
    {%- endif -%}

    {%- comment -%} Filter Tabs {%- endcomment -%}
    <div class="blog-page__filter-bar">
      <div class="blog-page__filter-tags">
        <a href="{{ blog.url }}" class="blog-page__filter-tag{% unless current_tags %} blog-page__filter-tag--active{% endunless %}">
          {{ 'blogs.all' | t }}
        </a>
        {%- for tag in blog.all_tags -%}
          <a
            href="{{ blog.url }}/tagged/{{ tag | handleize }}"
            class="blog-page__filter-tag{% if current_tags contains tag %} blog-page__filter-tag--active{% endif %}"
          >
            {{ tag }}
          </a>
        {%- endfor -%}
      </div>
    </div>

    {%- comment -%} Article Grid {%- endcomment -%}
    {%- paginate blog.articles by section.settings.articles_per_page -%}
      <div class="blog-page__grid">
        {%- for article in blog.articles -%}
          {%- unless section.settings.show_featured and forloop.first and paginate.current_page == 1 -%}
            {% render 'article-card', article: article %}
          {%- endunless -%}
        {%- else -%}
          <p class="blog-page__empty">No articles found</p>
        {%- endfor -%}
      </div>

      {%- if paginate.pages > 1 -%}
        <nav class="blog-page__pagination">
          {%- if paginate.previous -%}
            <a href="{{ paginate.previous.url }}">Previous</a>
          {%- endif -%}
          <span>Page {{ paginate.current_page }} of {{ paginate.pages }}</span>
          {%- if paginate.next -%}
            <a href="{{ paginate.next.url }}">Next</a>
          {%- endif -%}
        </nav>
      {%- endif -%}
    {%- endpaginate -%}
  </div>
</section>

{% style %}
  .section-{{ section.id }} {
    padding-bottom: 4rem;
  }

  @media (min-width: 768px) {
    .section-{{ section.id }} {
      padding-bottom: 6rem;
    }
  }

  .blog-page__hero {
    padding: 4rem 0;
    text-align: center;
    background: #f9fafb;
    margin-bottom: 3rem;
  }

  @media (min-width: 768px) {
    .blog-page__hero {
      padding: 6rem 0;
      margin-bottom: 4rem;
    }
  }

  .blog-page__title {
    font-size: 2.5rem;
    font-weight: 900;
    letter-spacing: -0.05em;
    margin: 0;
  }

  @media (min-width: 768px) {
    .blog-page__title {
      font-size: 4rem;
    }
  }

  .blog-page__description {
    max-width: 600px;
    margin: 1rem auto 0;
    color: #6b7280;
  }

  /* Featured */
  .blog-page__featured {
    margin-bottom: 3rem;
  }

  .blog-page__featured-link {
    display: grid;
    gap: 1.5rem;
    text-decoration: none;
    color: inherit;
  }

  @media (min-width: 768px) {
    .blog-page__featured-link {
      grid-template-columns: 1fr 1fr;
      gap: 3rem;
      align-items: center;
    }
  }

  .blog-page__featured-image {
    position: relative;
    aspect-ratio: 16 / 10;
    overflow: hidden;
    background: #f3f4f6;
  }

  .blog-page__featured-image img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    transition: transform 0.5s;
  }

  .blog-page__featured-link:hover .blog-page__featured-image img {
    transform: scale(1.05);
  }

  .blog-page__featured-category {
    position: absolute;
    top: 1rem;
    left: 1rem;
    padding: 0.25rem 0.75rem;
    font-size: 0.625rem;
    font-weight: 900;
    text-transform: uppercase;
    letter-spacing: 0.1em;
    background: #fff;
    color: #000;
  }

  .blog-page__featured-title {
    font-size: 1.5rem;
    font-weight: 900;
    letter-spacing: -0.02em;
    margin: 0 0 1rem;
    transition: color 0.2s;
  }

  @media (min-width: 768px) {
    .blog-page__featured-title {
      font-size: 2rem;
    }
  }

  .blog-page__featured-link:hover .blog-page__featured-title {
    color: #6b7280;
  }

  .blog-page__featured-excerpt {
    color: #6b7280;
    margin: 0 0 1.5rem;
    line-height: 1.7;
  }

  .blog-page__featured-meta {
    font-size: 0.75rem;
    font-weight: 500;
    color: #9ca3af;
  }

  /* Filter */
  .blog-page__filter-bar {
    padding: 1rem 0;
    margin-bottom: 2rem;
    border-bottom: 1px solid #f3f4f6;
  }

  .blog-page__filter-tags {
    display: flex;
    flex-wrap: wrap;
    gap: 0.5rem;
  }

  .blog-page__filter-tag {
    padding: 0.5rem 1rem;
    font-size: 0.75rem;
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 0.05em;
    color: #6b7280;
    background: #f9fafb;
    text-decoration: none;
    transition: all 0.2s;
  }

  .blog-page__filter-tag:hover,
  .blog-page__filter-tag--active {
    background: #000;
    color: #fff;
  }

  /* Grid */
  .blog-page__grid {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 1rem;
  }

  @media (min-width: 768px) {
    .blog-page__grid {
      grid-template-columns: repeat(3, 1fr);
      gap: 2.5rem;
    }
  }

  .blog-page__empty {
    grid-column: 1 / -1;
    text-align: center;
    padding: 4rem;
    color: #9ca3af;
  }

  /* Pagination */
  .blog-page__pagination {
    display: flex;
    justify-content: center;
    align-items: center;
    gap: 2rem;
    margin-top: 3rem;
    padding-top: 2rem;
    border-top: 1px solid #f3f4f6;
    font-size: 0.875rem;
  }

  .blog-page__pagination a {
    font-weight: 700;
    color: #000;
    text-decoration: none;
  }

  .blog-page__pagination span {
    color: #9ca3af;
  }
{% endstyle %}

{% schema %}
{
  "name": "Blog page",
  "tag": "section",
  "class": "blog-section",
  "settings": [
    {
      "type": "checkbox",
      "id": "show_description",
      "label": "Show blog description",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "show_featured",
      "label": "Show featured article",
      "default": true
    },
    {
      "type": "range",
      "id": "articles_per_page",
      "label": "Articles per page",
      "min": 6,
      "max": 24,
      "step": 3,
      "default": 9
    }
  ],
  "templates": ["blog"]
}
{% endschema %}
